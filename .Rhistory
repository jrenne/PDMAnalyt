par(mfrow=c(1,1))
par(plt=c(.1,.95,.1,.85))
plot(1:max_mat,rep(0,max_mat),
xlab="",ylab="",type="l",ylim=c(-.01,.14),lwd=2,col="white")
lower_bound <- avg_nominal_returns - 1.0 * Std_nominal_returns
upper_bound <- avg_nominal_returns + 1.0 * Std_nominal_returns
polygon(c(1:max_mat,rev(1:max_mat)),c(lower_bound,rev(upper_bound)),border = NaN,
col="#66AAAA44")
lines(1:max_mat,avg_nominal_returns,col="blue",lwd=2)
# lower_bound <- avg_real_yds - 1.0 * Std_real_yds
# upper_bound <- avg_real_yds + 1.0 * Std_real_yds
# polygon(c(1:max_mat,rev(1:max_mat)),c(lower_bound,rev(upper_bound)),border = NaN,
#         col="#AA66AA44")
lines(1:max_mat,avg_TIPS_returns,col="red",lwd=2)
lower_bound <- avg_GDPLB_returns - 1.0 * Std_GDPLB_returns
upper_bound <- avg_GDPLB_returns + 1.0 * Std_GDPLB_returns
polygon(c(1:max_mat,rev(1:max_mat)),c(lower_bound,rev(upper_bound)),border = NaN,
col="#AAAAAA44")
lines(1:max_mat,avg_GDPLB_returns,col="black",lwd=2,lty=2)
grid()
dev.off()
FILE = paste("figures/Figure_expected_returns.pdf",sep="")
pdf(file=FILE, pointsize=10, width=6, height=6)
par(mfrow=c(1,1))
par(plt=c(.1,.95,.1,.85))
plot(1:max_mat,rep(0,max_mat),
xlab="",ylab="",type="l",ylim=c(0.02,.12),lwd=2,col="white")
lower_bound <- avg_nominal_returns - 1.0 * Std_nominal_returns
upper_bound <- avg_nominal_returns + 1.0 * Std_nominal_returns
polygon(c(1:max_mat,rev(1:max_mat)),c(lower_bound,rev(upper_bound)),border = NaN,
col="#66AAAA44")
lines(1:max_mat,avg_nominal_returns,col="blue",lwd=2)
# lower_bound <- avg_real_yds - 1.0 * Std_real_yds
# upper_bound <- avg_real_yds + 1.0 * Std_real_yds
# polygon(c(1:max_mat,rev(1:max_mat)),c(lower_bound,rev(upper_bound)),border = NaN,
#         col="#AA66AA44")
lines(1:max_mat,avg_TIPS_returns,col="red",lwd=2)
lower_bound <- avg_GDPLB_returns - 1.0 * Std_GDPLB_returns
upper_bound <- avg_GDPLB_returns + 1.0 * Std_GDPLB_returns
polygon(c(1:max_mat,rev(1:max_mat)),c(lower_bound,rev(upper_bound)),border = NaN,
col="#AAAAAA44")
lines(1:max_mat,avg_GDPLB_returns,col="black",lwd=2,lty=2)
grid()
dev.off()
nb_m <- 3
low_pi <- -.01
med_pi <- .03
hig_pi <- .07
low_y <- -.01
med_y <- .02
hig_y <- .05
mu_pi <- matrix(c(low_pi,med_pi,hig_pi),ncol=1)
mu_y  <- matrix(c(low_y,med_y,hig_y),ncol=1)
mu_pi
mu_y
rho <- .8
Omega <- diag(rep(rho,3))
Omega
rho <- .8
Omega <- diag(rep(rho,3))
Omega[1,2] <- 1 - rho
Omega[3,2] <- 1 - rho
Omega[2,1] <- (1 - rho)/2
Omega[2,3] <- (1 - rho)/2
Omega
source("~/Dropbox/Research/PDMAnalyt/tempo_demand_supply.R", echo=TRUE)
Model
plot(1:max_mat,rep(0,max_mat),
xlab="",ylab="",type="l",ylim=c(0.02,.12),lwd=2,col="white")
lower_bound <- avg_nominal_returns - 1.0 * Std_nominal_returns
upper_bound <- avg_nominal_returns + 1.0 * Std_nominal_returns
polygon(c(1:max_mat,rev(1:max_mat)),c(lower_bound,rev(upper_bound)),border = NaN,
col="#66AAAA44")
lines(1:max_mat,avg_nominal_returns,col="blue",lwd=2)
# lower_bound <- avg_real_yds - 1.0 * Std_real_yds
# upper_bound <- avg_real_yds + 1.0 * Std_real_yds
# polygon(c(1:max_mat,rev(1:max_mat)),c(lower_bound,rev(upper_bound)),border = NaN,
#         col="#AA66AA44")
lines(1:max_mat,avg_TIPS_returns,col="red",lwd=2)
lower_bound <- avg_GDPLB_returns - 1.0 * Std_GDPLB_returns
upper_bound <- avg_GDPLB_returns + 1.0 * Std_GDPLB_returns
polygon(c(1:max_mat,rev(1:max_mat)),c(lower_bound,rev(upper_bound)),border = NaN,
col="#AAAAAA44")
lines(1:max_mat,avg_GDPLB_returns,col="black",lwd=2,lty=2)
maxH
source("~/Dropbox/Research/PDMAnalyt/procedures/proc_toymodel.R", echo=TRUE)
res_returns_yds <- prepare_returns_yds(Model,maxH)
Model_nominal <- Model
Model_nominal$kappa_pi <- 0
Model_nominal$kappa_y  <- 0
res_LTnominal_prices <- compute_LTRF_bond_prices(Model_nominal,maxH=maxH)
Model_nominal
load(file="results/res_12082024.Rdat")
res_returns_yds <- prepare_returns_yds(Model,maxH)
nb_m
nb_m <- dim(Model$Omega)[1]
nb_
nb_m
source("~/Dropbox/Research/PDMAnalyt/procedures/proc_toymodel.R", echo=TRUE)
res_returns_yds <- prepare_returns_yds(Model,maxH)
RES <- prepare_returns_yds(Model,maxH)
RES$TIPS_yds
plot(c(RES$avg_nominal_yds),type="l",ylim=c(0,.08))
RES$avg_nominal_yds
plot(c(RES$avg_nominal_yds),type="l",ylim=c(0,.08))
lines(c(RES$avg_TIPS_yds),col="red")
plot(c(RES$avg_nominal_returns),type="l")
plot(c(RES$avg_nominal_returns),type="l")
lines(c(RES$avg_TIPS_returns),col="red")
lines(c(RES$avg_GDPLB_returns),col="black",lty=2)
RES$avg_nominal_returns
RES$res_LTnominal_prices$all_LT_rth
fitted_yds_nom  <- res_KH$ksi_matrix %*% RES$res_LTnominal_prices$all_LT_rth
fitted_yds_real <- res_KH$ksi_matrix %*% RES$res_LTreal_prices$all_LT_rth
RES$res_LTnominal_prices$all_LT_rth
dim(res_KH$ksi_matrix)
fitted_yds_nom  <- res_KH$ksi_matrix %*% RES$res_LTnominal_prices$all_LT_rth
fitted_yds_real <- res_KH$ksi_matrix %*% RES$res_LTreal_prices$all_LT_rth
fitted_yds_real <- res_KH$ksi_matrix %*% RES$res_LTTIPS_prices$all_LT_rth
lower_bound <- RES$avg_TIPS_yds - 1.0 * RES$Std_TIPS_yds
upper_bound <- RES$avg_TIPS_yds + 1.0 * RES$Std_TIPS_yds
plot(1:maxH,rep(0,maxH),
xlab="",ylab="",type="l",ylim=c(-.01,.10),lwd=2,col="white")
lower_bound <- RES$avg_nominal_yds - 1.0 * RES$Std_nominal_yds
upper_bound <- RES$avg_nominal_yds + 1.0 * RES$Std_nominal_yds
polygon(c(1:maxH,rev(1:maxH)),c(lower_bound,rev(upper_bound)),border = NaN,
col="#66AAAA44")
lines(1:maxH,RES$avg_nominal_yds,col="blue",lwd=2)
lower_bound <- RES$avg_TIPS_yds - 1.0 * RES$Std_TIPS_yds
upper_bound <- RES$avg_TIPS_yds + 1.0 * RES$Std_TIPS_yds
polygon(c(1:maxH,rev(1:maxH)),c(lower_bound,rev(upper_bound)),border = NaN,
col="#AA66AA44")
lines(1:maxH,RES$avg_TIPS_yds,col="red",lwd=2)
plot(1:maxH,rep(0,maxH),
xlab="",ylab="",type="l",ylim=c(0.02,.12),lwd=2,col="white")
lower_bound <- RES$avg_nominal_returns - 1.0 * RES$Std_nominal_returns
upper_bound <- RES$avg_nominal_returns + 1.0 * RES$Std_nominal_returns
polygon(c(1:maxH,rev(1:maxH)),c(lower_bound,rev(upper_bound)),border = NaN,
col="#66AAAA44")
RES$avg_nominal_returns
lines(1:maxH,c(RES$avg_nominal_returns),col="blue",lwd=2)
lower_bound <- RES$avg_nominal_returns - 1.0 * RES$Std_nominal_returns
upper_bound <- RES$avg_nominal_returns + 1.0 * RES$Std_nominal_returns
polygon(c(1:maxH,rev(1:maxH)),c(lower_bound,rev(upper_bound)),border = NaN,
col="#66AAAA44")
lower_bound
RES$avg_nominal_returns
RES$Std_nominal_returns
plot(1:maxH,rep(0,maxH),
xlab="",ylab="",type="l",ylim=c(0.02,.12),lwd=2,col="white")
lower_bound <- RES$avg_annual_nominal_returns - 1.0 * RES$Std_annual_nominal_returns
upper_bound <- RES$avg_annual_nominal_returns + 1.0 * RES$Std_annual_nominal_returns
polygon(c(1:maxH,rev(1:maxH)),c(lower_bound,rev(upper_bound)),border = NaN,
col="#66AAAA44")
lines(1:maxH,c(RES$avg_annual_nominal_returns),col="blue",lwd=2)
plot(1:maxH,rep(0,maxH),
xlab="",ylab="",type="l",ylim=c(0.02,.12),lwd=2,col="white")
lower_bound <- RES$avg_annual_nominal_returns - 1.0 * RES$Std_annual_nominal_returns
upper_bound <- RES$avg_annual_nominal_returns + 1.0 * RES$Std_annual_nominal_returns
polygon(c(1:maxH,rev(1:maxH)),c(lower_bound,rev(upper_bound)),border = NaN,
col="#66AAAA44")
lines(1:maxH,c(RES$avg_annual_nominal_returns),col="blue",lwd=2)
# lower_bound <- avg_real_yds - 1.0 * Std_real_yds
# upper_bound <- avg_real_yds + 1.0 * Std_real_yds
# polygon(c(1:maxH,rev(1:maxH)),c(lower_bound,rev(upper_bound)),border = NaN,
#         col="#AA66AA44")
lines(1:maxH,RES$avg_annual_TIPS_returns,col="red",lwd=2)
lower_bound <- RES$avg_annual_GDPLB_returns - 1.0 * RES$Std_annual_GDPLB_returns
upper_bound <- RES$avg_annual_GDPLB_returns + 1.0 * RES$Std_annual_GDPLB_returns
polygon(c(1:maxH,rev(1:maxH)),c(lower_bound,rev(upper_bound)),border = NaN,
col="#AAAAAA44")
lines(1:maxH,RES$avg_annual_GDPLB_returns,col="black",lwd=2,lty=2)
source("~/Dropbox/Research/PDMAnalyt/make_chart_fit.R", echo=TRUE)
source("~/Dropbox/Research/PDMAnalyt/tempo_demand_supply.R", echo=TRUE)
source("~/Dropbox/Research/PDMAnalyt/tempo_demand_supply.R", echo=TRUE)
source("~/Dropbox/Research/PDMAnalyt/tempo_demand_supply.R", echo=TRUE)
nb_m <- dim(Model$Omega)[1]
# Compute (LT) nominal bond prices:
Model_nominal <- Model
Model_nominal$kappa_pi <- 0
Model_nominal$kappa_y  <- 0
res_LTnominal_prices <- compute_LTRF_bond_prices(Model_nominal,maxH=maxH)
# Compute (LT) real bond prices:
Model_TIPS <- Model
Model_TIPS$kappa_pi <- 1
Model_TIPS$kappa_y  <- 0
res_LTTIPS_prices <- compute_LTRF_bond_prices(Model_TIPS,maxH=maxH)
# Compute (LT) TIPS bond prices:
Model_GDPLB <- Model
Model_GDPLB$kappa_pi <- 1
Model_GDPLB$kappa_y  <- 1
res_LTGDPLB_prices   <- compute_LTRF_bond_prices(Model_GDPLB,maxH=maxH)
stat_distri <- compute_stat_distri(Model)
nominal_yds <- res_LTnominal_prices$all_LT_rth
TIPS_yds    <- res_LTTIPS_prices$all_LT_rth
GDPLB_yds   <- res_LTGDPLB_prices$all_LT_rth
avg_nominal_yds <- t(stat_distri) %*% nominal_yds
avg_TIPS_yds    <- t(stat_distri) %*% TIPS_yds
avg_GDPLB_yds   <- t(stat_distri) %*% GDPLB_yds
avg_nominal_returns <- t(stat_distri) %*% res_LTnominal_prices$all_LT_ExpReturn_th
avg_TIPS_returns    <- t(stat_distri) %*% res_LTTIPS_prices$all_LT_ExpReturn_th
avg_GDPLB_returns   <- t(stat_distri) %*% res_LTGDPLB_prices$all_LT_ExpReturn_th
Var_nominal_yds <- t(stat_distri) %*% res_LTnominal_prices$all_LT_rth^2 - avg_nominal_yds^2
Var_TIPS_yds    <- t(stat_distri) %*% res_LTTIPS_prices$all_LT_rth^2    - avg_TIPS_yds^2
Var_GDPLB_yds   <- t(stat_distri) %*% res_LTGDPLB_prices$all_LT_rth^2   - avg_GDPLB_yds^2
Std_nominal_yds <- sqrt(Var_nominal_yds)
Std_TIPS_yds    <- sqrt(Var_TIPS_yds)
Std_GDPLB_yds   <- sqrt(Var_GDPLB_yds)
exp_log_nominal_returns <- log(res_LTnominal_prices$all_LT_ExpReturn_th)
exp_log_TIPS_returns    <- log(res_LTTIPS_prices$all_LT_ExpReturn_th)
exp_log_GDPLB_returns   <- log(res_LTGDPLB_prices$all_LT_ExpReturn_th)
exp_annual_nominal_returns <- exp_log_nominal_returns/t(matrix(1:maxH,maxH,nb_m))
exp_annual_TIPS_returns    <- exp_log_TIPS_returns/t(matrix(1:maxH,maxH,nb_m))
exp_annual_GDPLB_returns   <- exp_log_GDPLB_returns/t(matrix(1:maxH,maxH,nb_m))
avg_annual_nominal_returns <- c(t(stat_distri) %*% exp_annual_nominal_returns)
avg_annual_TIPS_returns    <- c(t(stat_distri) %*% exp_annual_TIPS_returns)
avg_annual_GDPLB_returns   <- c(t(stat_distri) %*% exp_annual_GDPLB_returns)
Var_annual_nominal_returns <- t(stat_distri) %*% exp_annual_nominal_returns^2 - avg_annual_nominal_returns^2
Var_annual_TIPS_returns    <- t(stat_distri) %*% exp_annual_TIPS_returns^2    - avg_annual_TIPS_returns^2
Var_annual_GDPLB_returns   <- t(stat_distri) %*% exp_annual_GDPLB_returns^2   - avg_annual_GDPLB_returns^2
Std_annual_nominal_returns <- sqrt(Var_annual_nominal_returns)
Std_annual_TIPS_returns    <- sqrt(Var_annual_TIPS_returns)
Std_annual_GDPLB_returns   <- sqrt(Var_annual_GDPLB_returns)
nb_m <- dim(Model$Omega)[1]
# Compute (LT) nominal bond prices:
Model_nominal <- Model
Model_nominal$kappa_pi <- 0
Model_nominal$kappa_y  <- 0
res_LTnominal_prices <- compute_LTRF_bond_prices(Model_nominal,maxH=maxH)
# Compute (LT) real bond prices:
Model_TIPS <- Model
Model_TIPS$kappa_pi <- 1
Model_TIPS$kappa_y  <- 0
res_LTTIPS_prices <- compute_LTRF_bond_prices(Model_TIPS,maxH=maxH)
# Compute (LT) TIPS bond prices:
Model_GDPLB <- Model
Model_GDPLB$kappa_pi <- 1
Model_GDPLB$kappa_y  <- 1
res_LTGDPLB_prices   <- compute_LTRF_bond_prices(Model_GDPLB,maxH=maxH)
stat_distri <- compute_stat_distri(Model)
nominal_yds <- res_LTnominal_prices$all_LT_rth
TIPS_yds    <- res_LTTIPS_prices$all_LT_rth
GDPLB_yds   <- res_LTGDPLB_prices$all_LT_rth
avg_nominal_yds <- t(stat_distri) %*% nominal_yds
avg_TIPS_yds    <- t(stat_distri) %*% TIPS_yds
avg_GDPLB_yds   <- t(stat_distri) %*% GDPLB_yds
avg_nominal_returns <- t(stat_distri) %*% res_LTnominal_prices$all_LT_ExpReturn_th
avg_TIPS_returns    <- t(stat_distri) %*% res_LTTIPS_prices$all_LT_ExpReturn_th
avg_GDPLB_returns   <- t(stat_distri) %*% res_LTGDPLB_prices$all_LT_ExpReturn_th
Var_nominal_yds <- t(stat_distri) %*% res_LTnominal_prices$all_LT_rth^2 - avg_nominal_yds^2
Var_TIPS_yds    <- t(stat_distri) %*% res_LTTIPS_prices$all_LT_rth^2    - avg_TIPS_yds^2
Var_GDPLB_yds   <- t(stat_distri) %*% res_LTGDPLB_prices$all_LT_rth^2   - avg_GDPLB_yds^2
Std_nominal_yds <- sqrt(Var_nominal_yds)
Std_TIPS_yds    <- sqrt(Var_TIPS_yds)
Std_GDPLB_yds   <- sqrt(Var_GDPLB_yds)
exp_log_nominal_returns <- log(res_LTnominal_prices$all_LT_ExpReturn_th)
exp_log_TIPS_returns    <- log(res_LTTIPS_prices$all_LT_ExpReturn_th)
exp_log_GDPLB_returns   <- log(res_LTGDPLB_prices$all_LT_ExpReturn_th)
exp_annual_nominal_returns <- exp_log_nominal_returns/t(matrix(1:maxH,maxH,nb_m))
exp_annual_TIPS_returns    <- exp_log_TIPS_returns/t(matrix(1:maxH,maxH,nb_m))
exp_annual_GDPLB_returns   <- exp_log_GDPLB_returns/t(matrix(1:maxH,maxH,nb_m))
avg_annual_nominal_returns <- c(t(stat_distri) %*% exp_annual_nominal_returns)
avg_annual_TIPS_returns    <- c(t(stat_distri) %*% exp_annual_TIPS_returns)
avg_annual_GDPLB_returns   <- c(t(stat_distri) %*% exp_annual_GDPLB_returns)
Var_annual_nominal_returns <- t(stat_distri) %*% exp_annual_nominal_returns^2 - avg_annual_nominal_returns^2
Var_annual_TIPS_returns    <- t(stat_distri) %*% exp_annual_TIPS_returns^2    - avg_annual_TIPS_returns^2
Var_annual_GDPLB_returns   <- t(stat_distri) %*% exp_annual_GDPLB_returns^2   - avg_annual_GDPLB_returns^2
Std_annual_nominal_returns <- sqrt(Var_annual_nominal_returns)
Std_annual_TIPS_returns    <- sqrt(Var_annual_TIPS_returns)
Std_annual_GDPLB_returns   <- sqrt(Var_annual_GDPLB_returns)
source("~/Dropbox/Research/PDMAnalyt/tempo_demand_supply.R", echo=TRUE)
RES <- prepare_returns_yds(Model,maxH)
source("~/Dropbox/Research/PDMAnalyt/procedures/proc_toymodel.R", echo=TRUE)
nb_m <- dim(Model$Omega)[1]
# Compute (LT) nominal bond prices:
Model_nominal <- Model
Model_nominal$kappa_pi <- 0
Model_nominal$kappa_y  <- 0
res_LTnominal_prices <- compute_LTRF_bond_prices(Model_nominal,maxH=maxH)
# Compute (LT) real bond prices:
Model_TIPS <- Model
Model_TIPS$kappa_pi <- 1
Model_TIPS$kappa_y  <- 0
res_LTTIPS_prices <- compute_LTRF_bond_prices(Model_TIPS,maxH=maxH)
# Compute (LT) TIPS bond prices:
Model_GDPLB <- Model
Model_GDPLB$kappa_pi <- 1
Model_GDPLB$kappa_y  <- 1
res_LTGDPLB_prices   <- compute_LTRF_bond_prices(Model_GDPLB,maxH=maxH)
stat_distri <- compute_stat_distri(Model)
nominal_yds <- res_LTnominal_prices$all_LT_rth
TIPS_yds    <- res_LTTIPS_prices$all_LT_rth
GDPLB_yds   <- res_LTGDPLB_prices$all_LT_rth
avg_nominal_yds <- t(stat_distri) %*% nominal_yds
avg_TIPS_yds    <- t(stat_distri) %*% TIPS_yds
avg_GDPLB_yds   <- t(stat_distri) %*% GDPLB_yds
avg_nominal_returns <- t(stat_distri) %*% res_LTnominal_prices$all_LT_ExpReturn_th
avg_TIPS_returns    <- t(stat_distri) %*% res_LTTIPS_prices$all_LT_ExpReturn_th
avg_GDPLB_returns   <- t(stat_distri) %*% res_LTGDPLB_prices$all_LT_ExpReturn_th
Var_nominal_yds <- t(stat_distri) %*% res_LTnominal_prices$all_LT_rth^2 - avg_nominal_yds^2
Var_TIPS_yds    <- t(stat_distri) %*% res_LTTIPS_prices$all_LT_rth^2    - avg_TIPS_yds^2
Var_GDPLB_yds   <- t(stat_distri) %*% res_LTGDPLB_prices$all_LT_rth^2   - avg_GDPLB_yds^2
Std_nominal_yds <- sqrt(Var_nominal_yds)
Std_TIPS_yds    <- sqrt(Var_TIPS_yds)
Std_GDPLB_yds   <- sqrt(Var_GDPLB_yds)
exp_log_nominal_returns <- log(res_LTnominal_prices$all_LT_ExpReturn_th)
exp_log_TIPS_returns    <- log(res_LTTIPS_prices$all_LT_ExpReturn_th)
exp_log_GDPLB_returns   <- log(res_LTGDPLB_prices$all_LT_ExpReturn_th)
exp_annual_nominal_returns <- exp_log_nominal_returns/t(matrix(1:maxH,maxH,nb_m))
exp_annual_TIPS_returns    <- exp_log_TIPS_returns/t(matrix(1:maxH,maxH,nb_m))
exp_annual_GDPLB_returns   <- exp_log_GDPLB_returns/t(matrix(1:maxH,maxH,nb_m))
avg_annual_nominal_returns <- c(t(stat_distri) %*% exp_annual_nominal_returns)
avg_annual_TIPS_returns    <- c(t(stat_distri) %*% exp_annual_TIPS_returns)
avg_annual_GDPLB_returns   <- c(t(stat_distri) %*% exp_annual_GDPLB_returns)
Var_annual_nominal_returns <- t(stat_distri) %*% exp_annual_nominal_returns^2 - avg_annual_nominal_returns^2
Var_annual_TIPS_returns    <- t(stat_distri) %*% exp_annual_TIPS_returns^2    - avg_annual_TIPS_returns^2
Var_annual_GDPLB_returns   <- t(stat_distri) %*% exp_annual_GDPLB_returns^2   - avg_annual_GDPLB_returns^2
Std_annual_nominal_returns <- sqrt(Var_annual_nominal_returns)
Std_annual_TIPS_returns    <- sqrt(Var_annual_TIPS_returns)
Std_annual_GDPLB_returns   <- sqrt(Var_annual_GDPLB_returns)
Var_GDPLB_yds
stat_distri
Var_nominal_yds <- t(stat_distri) %*% nominal_yds^2 - avg_nominal_yds^2
Var_TIPS_yds    <- t(stat_distri) %*% TIPS_yds^2    - avg_TIPS_yds^2
Var_GDPLB_yds   <- t(stat_distri) %*% GDPLB_yds^2   - avg_GDPLB_yds^2
Var_GDPLB_yds
t(stat_distri) %*% GDPLB_yds
t(stat_distri) %*% GDPLB_yds^2   - avg_GDPLB_yds^2
t(stat_distri) %*% (GDPLB_yds^2)   - avg_GDPLB_yds^2
avg_GDPLB_yds
GDPLB_yds
Var_GDPLB_yds
source("~/Dropbox/Research/PDMAnalyt/tempo_demand_supply.R", echo=TRUE)
source("~/Dropbox/Research/PDMAnalyt/tempo_demand_supply.R", echo=TRUE)
source("~/Dropbox/Research/PDMAnalyt/tempo_demand_supply.R", echo=TRUE)
source("~/Dropbox/Research/PDMAnalyt/tempo_demand_supply.R", echo=TRUE)
source("~/Dropbox/Research/PDMAnalyt/tempo_demand_supply.R", echo=TRUE)
source("~/Dropbox/Research/PDMAnalyt/tempo_demand_supply.R", echo=TRUE)
View(Targets)
source("~/Dropbox/Research/PDMAnalyt/tempo_demand_supply.R", echo=TRUE)
source("~/Dropbox/Research/PDMAnalyt/tempo_demand_supply.R", echo=TRUE)
source("~/Dropbox/Research/PDMAnalyt/tempo_demand_supply.R", echo=TRUE)
source("~/Dropbox/Research/PDMAnalyt/tempo_demand_supply.R", echo=TRUE)
source("~/Dropbox/Research/PDMAnalyt/tempo_demand_supply.R", echo=TRUE)
source("~/Dropbox/Research/PDMAnalyt/procedures/proc_toymodel.R", echo=TRUE)
source("~/Dropbox/Research/PDMAnalyt/procedures/proc_toymodel.R", echo=TRUE)
source("~/Dropbox/Research/PDMAnalyt/Run_PDM.R", echo=TRUE)
load(file="results/res_12082024.Rdat")
source("~/Dropbox/Research/PDMAnalyt/Run_PDM.R", echo=TRUE)
Model$chi
source("~/Dropbox/Research/PDMAnalyt/tempo_demand_supply.R", echo=TRUE)
Model <- Model_Demand
res_stat_distri_and_rbar <- compute_stat_distri_and_rbar(Model)
Model_nominal$kappa_pi <- 0
Model_nominal$kappa_y  <- 0
Model_nominal$chi <- chi / exp(Model_nominal$kappa_pi*mean_pi + Model_nominal$kappa_y*mean_y)
res_stat_distri_and_rbar <- compute_stat_distri_and_rbar(Model)
res_stat_distri_and_rbar <- compute_stat_distri_and_rbar(Model)
res_stat_distri <- compute_stat_distri(Model)
stat_distri <- res_stat_distri_and_rbar$stat_distri
mean_pi <- c(t(stat_distri) %*% Model$mu_pi)
stat_distri
Model <- Model_Demand
res_stat_distri <- compute_stat_distri(Model)
stat_distri <- res_stat_distri_and_rbar$stat_distri
mean_pi <- c(t(stat_distri) %*% Model$mu_pi)
stat_distri <- compute_stat_distri(Model)
mean_pi <- c(t(stat_distri) %*% Model$mu_pi)
mean_y  <- c(t(stat_distri) %*% Model$mu_y)
source("~/Dropbox/Research/PDMAnalyt/procedures/proc_toymodel.R", echo=TRUE)
Models <- prepare_and_solve_3(Model_Demand,
all_d,all_rr,all_eps,proba_eps)
Model_Demand$chi <- .8
Model_Demand$mu_eta <- 1*Model_Demand$mu_y
Models <- prepare_and_solve_3(Model_Demand,
all_d,all_rr,all_eps,proba_eps)
load(file="results/res_12082024.Rdat")
Model$beta
Model$alpha
Model$d_star
Model_Demand$chi    <- .8
Model_Demand$mu_eta <- 1*Model_Demand$mu_y
Model_Demand$beta   <- .1
Model_Demand$alpha  <- .3
Model_Demand$d_star <- .8
Model_Demand$s_star <- .05
Models <- prepare_and_solve_3(Model_Demand,
all_d,all_rr,all_eps,proba_eps)
Model_Demand$chi    <- .8
Model_Demand$mu_eta <- 1*Model_Demand$mu_y
Model_Demand$beta   <- .1
Model_Demand$alpha  <- .3
Model_Demand$d_star <- .8
Model_Demand$s_star <- .05
Model_Demand$RR     <- .5
Models <- prepare_and_solve_3(Model_Demand,
all_d,all_rr,all_eps,proba_eps)
Model_Demand$chi    <- .8
Model_Demand$mu_eta <- 1*Model_Demand$mu_y
Model_Demand$beta   <- .1
Model_Demand$alpha  <- .3
Model_Demand$d_star <- .8
Model_Demand$s_star <- .05
Model_Demand$RR     <- .5
Model_Demand$nu_pi  <- 0
Model_Demand$nu_y   <- 0
Models <- prepare_and_solve_3(Model_Demand,
all_d,all_rr,all_eps,proba_eps)
strat_nominal <- run_strategy(Models$Model_solved_nominal,maxH=10)
strat_TIPS    <- run_strategy(Models$Model_solved_TIPS,maxH=10)
strat_GDPLB   <- run_strategy(Models$Model_solved_GDPLB,maxH=10)
M <- rbind(c(strat_nominal$mean_d,strat_TIPS$mean_d,strat_GDPLB$mean_d),
c(strat_nominal$stdv_d,strat_TIPS$stdv_d,strat_GDPLB$stdv_d),
c(strat_nominal$mean_rr,strat_TIPS$mean_rr,strat_GDPLB$mean_rr),
c(strat_nominal$stdv_rr,strat_TIPS$stdv_rr,strat_GDPLB$stdv_rr),
c(strat_nominal$mean_Delta_d,strat_TIPS$mean_Delta_d,strat_GDPLB$mean_Delta_d),
c(strat_nominal$stdv_Delta_d,strat_TIPS$stdv_Delta_d,strat_GDPLB$stdv_Delta_d))
colnames(M) <- c("Nominal","TIPS","GDPLB")
rownames(M) <- c("Mean d","Stdv d",
"Mean r","Stdv r",
"Mean D(d)","Stdv D(d)")
print(M)
source("~/Dropbox/Research/PDMAnalyt/tempo_demand_supply.R", echo=TRUE)
print(M)
load(file="results/res_12082024.Rdat")
Model$sigma_eps
Model$mu_eta
Model$mu_pi
Model$mu_y
compute_stat_distri(Model)
source("~/Dropbox/Research/PDMAnalyt/calibrate_alpha_beta.R", echo=TRUE)
nb_m
stat_distri
res_LTnominal_prices$all_LT_rth
res_LTnominal_prices <- compute_LTRF_bond_prices(Model,maxH = 10)
stat_distri <- res_stat_distri_and_rbar$stat_distri
q <- c(t(stat_distri) %*% res_LTnominal_prices$all_LT_rth[,10])
D <- 6
Model$chi <- 1 + q - 1/D
Model$chi
source("~/Dropbox/Research/PDMAnalyt/calibrate_alpha_beta.R", echo=TRUE)
Model$alpha  <- best$alpha
Model$beta   <- best$beta
Model$d_star <- best$d_star
best$alpha
best$beta
best$d_star
plot(all_d,best$distri_d,type="l")
save(Model,file="results/res_12082024.Rdat")
PD_TIPS <- compute_proba_def(maxH=maxH,
indicators_x  = res0_TIPS$indicators_x,
all_proba_def = res0_TIPS$all_proba_def,
Probas        = res0_TIPS$Probas)
# Compute bond prices (no default):
res_LTprices <- compute_LTRF_bond_prices(Model_solved$Model,maxH)
# Compute average expected returns (no default):
avgLT_ExpReturns  <- c(t(Model_solved$stat_distri) %*% res_LTprices$all_LT_ExpReturn_th)
# Compute probabilities of default:
PD <- compute_proba_def(maxH=maxH,
indicators_x  = Model_solved$indicators_x,
all_proba_def = Model_solved$all_proba_def,
Probas        = Model_solved$Probas)
PD
dim(PD)
avg_PD <- t(p) %*% PD
dim(p)
dim(PD)
source("~/Dropbox/Research/PDMAnalyt/procedures/proc_toymodel.R", echo=TRUE)
strat_nominal <- run_strategy(Models$Model_solved_nominal,maxH=10)
source("~/Dropbox/Research/PDMAnalyt/procedures/proc_toymodel.R", echo=TRUE)
strat_nominal <- run_strategy(Models$Model_solved_nominal,maxH=10)
strat_nominal$avg_PD
strat_nominal <- run_strategy(Models$Model_solved_nominal,maxH=10)
strat_TIPS    <- run_strategy(Models$Model_solved_TIPS,maxH=10)
strat_GDPLB   <- run_strategy(Models$Model_solved_GDPLB,maxH=10)
M <- rbind(c(strat_nominal$mean_d,strat_TIPS$mean_d,strat_GDPLB$mean_d),
c(strat_nominal$stdv_d,strat_TIPS$stdv_d,strat_GDPLB$stdv_d),
c(strat_nominal$mean_rr,strat_TIPS$mean_rr,strat_GDPLB$mean_rr),
c(strat_nominal$stdv_rr,strat_TIPS$stdv_rr,strat_GDPLB$stdv_rr),
c(strat_nominal$mean_Delta_d,strat_TIPS$mean_Delta_d,strat_GDPLB$mean_Delta_d),
c(strat_nominal$stdv_Delta_d,strat_TIPS$stdv_Delta_d,strat_GDPLB$stdv_Delta_d),
c(strat_nominal$avg_PD[maxH],strat_TIPS$avg_PD[maxH],strat_GDPLB$avg_PD[maxH]))
colnames(M) <- c("Nominal","TIPS","GDPLB")
rownames(M) <- c("Mean d","Stdv d",
"Mean r","Stdv r",
"Mean D(d)","Stdv D(d)","avg PD")
print(M)
source("~/Dropbox/Research/PDMAnalyt/Run_PDM.R", echo=TRUE)
Mchi09 <- M
source("~/Dropbox/Research/PDMAnalyt/Run_PDM.R", echo=TRUE)
Mchi09
M <- rbind(c(strat_nominal$mean_d,strat_TIPS$mean_d,strat_GDPLB$mean_d),
c(strat_nominal$stdv_d,strat_TIPS$stdv_d,strat_GDPLB$stdv_d),
c(strat_nominal$mean_rr,strat_TIPS$mean_rr,strat_GDPLB$mean_rr),
c(strat_nominal$stdv_rr,strat_TIPS$stdv_rr,strat_GDPLB$stdv_rr),
c(strat_nominal$stdv_Delta_d,strat_TIPS$stdv_Delta_d,strat_GDPLB$stdv_Delta_d),
c(strat_nominal$avg_PD[maxH],strat_TIPS$avg_PD[maxH],strat_GDPLB$avg_PD[maxH]))
colnames(M) <- c("Nominal","TIPS","GDPLB")
rownames(M) <- c("Mean d","Stdv d",
"Mean r","Stdv r",
"Stdv D(d)","avg PD")
M <- rbind(c(strat_nominal$mean_d,strat_TIPS$mean_d,strat_GDPLB$mean_d),
c(strat_nominal$stdv_d,strat_TIPS$stdv_d,strat_GDPLB$stdv_d),
c(strat_nominal$mean_rr,strat_TIPS$mean_rr,strat_GDPLB$mean_rr),
c(strat_nominal$stdv_rr,strat_TIPS$stdv_rr,strat_GDPLB$stdv_rr),
c(strat_nominal$stdv_Delta_d,strat_TIPS$stdv_Delta_d,strat_GDPLB$stdv_Delta_d),
c(strat_nominal$avg_PD[maxH],strat_TIPS$avg_PD[maxH],strat_GDPLB$avg_PD[maxH]))
colnames(M) <- c("Nominal","TIPS","GDPLB")
rownames(M) <- c("Mean d","Stdv d",
"Mean r","Stdv r",
"Stdv D(d)","avg PD")
print(M)
